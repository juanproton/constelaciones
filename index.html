<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Constelaciones</title>
	<script src="libraries/p5.js"></script>
	<script src="libraries/p5.dom.js"></script>
	<script src="libraries/p5.sound.js"></script>
	<script>

	let planet = [];
	let att;
	var postsIndex;
	var labels = [];
	var title;
	var date;
	var content;
	var posts = [];
	var url;
	var r = 300;;
	var val = 0;
	var button;
	var inside = false;
	let pr;
	var time = 0;
	var rr = 0;
	var font;
	var mainGraphic;
	var offGraphic;

	var dateOrder;
	var labelOrder;
	var displayLines;
	var option;
	var input;
	var inputButton;
	var xX = 100;


	function setup() {
		mainGraphic = createGraphics(800, 800);

	  createCanvas(window.innerWidth, window.innerHeight);
		att = new Attractor(width/2+200, height/2);
	  background(0);
		inside = false;
	  loadJSON('https://www.googleapis.com/blogger/v3/blogs/6221658020817299874/posts?maxResults=40&key=AIzaSyBgX-VyMBkl10Uyknz383uXs1V7nPBXFrg', gotData);
	  smooth();
		colorMode(HSB, 255);


		pr = new Preview();
		strokeWeight(4);

		dateOrder = createButton('fecha', false);
		dateOrder.position(50, xX);
		option = createSelect();
		option.position(50, xX);
		option.option("fecha");
		option.option("label");
		option.option("unidad");
		option.changed(mySelectEvent);
		// labelOrder = createButton('tag', false);
		// labelOrder.position(50, xX+25);
		// displayLines = createButton('connexi√≥n', false);
		// displayLines.position(50, xX+50);

		input = createInput();
		input.position(50, xX+25);

		inputButton = createButton("buscar");
		inputButton.position(185, xX+25);
		inputButton.mousePressed(search);
		// button.mousePressed();

	}

	function mySelectEvent() {
	  var item = option.value();
		textFont('Helvetica');
 	  stroke(0);
 		fill(0);
 		textStyle(NORMAL);
 		textSize(20);
	  text('It is a ' + item + '!', 50, 250);

		if(item == "fecha"){
			console.log("FECHA");
		}
		if(item == "label"){
			console.log("LABEL");
		}
		if(item == "unidad"){
			console.log("UNIDAD");
		}

	}

	function search(){
		const name = input.value();
		console.log(name);
	}

	function changebackground() {
	  val = random(lerpColor(255, 0, 0.5));
	}

	function gotData(data) {
	  // console.log(data.items.length);
	  postsIndex = data.items.length;
	  posts = data.items;

			console.log(postsIndex);

	  // fill(255);

	  text("posts: " + postsIndex, 50, 100);

	  for (var i = 0; i < postsIndex; i++) {
	    labels = data.items[i].labels;
	    title = data.items[i].title;
			url = data.items[i].url;
			date = data.items[i].published;
			content = data.items[i].content;

	    var radius = random(r);
	    var a = random(TWO_PI);
	    var x = width / 2 + 200 + cos(a) * radius;
	    var y = height / 2  + sin(a) * radius;

	    let p = new Planet(x, y, 5, labels, title,url,date,content, i, random(0, 255), 255, 100, random(100));
	    var overlapping = false;

	    for (var j = 0; j < planet.length; j++) {
	      var other = planet[j];
	      var d = dist(p.v1.x, p.v1.y, other.v1.x, other.v1.y);
	      if (d < p.r + other.r) {
	        overlapping = true;
	        break;
	      }
	    }
	    if (!overlapping) {
	      planet.push(p);
	    }
	  }

	}

	function draw() {
		
	}

	</script>

	<style>
		body {
			margin:0;
			padding:0;
			overflow: hidden;
		}
		canvas {
			margin:auto;
		}
	</style>
</head>
<body>
</body>
</html>
